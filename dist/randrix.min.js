/* !
 * randrix 1.0.2
 * https://github.com/exiguus/js.randrix.git
 *
 * Simon Gattner <npm@0x38.de>
 * Released under the MIT license
 *
 * Date: 2019-04-12 19:04:05
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Randrix=e():t.Randrix=e()}(window,function(){return function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();
var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return n(t,null,[{key:"options",value:function(t){var e="";switch(!0){case"object"!==(void 0===t?"undefined":r(t))||Array.isArray(t):e="options must be an object";break;case"string"!=typeof t.message||0===t.message.length:e="options.message must be a string > 0";break;case"string"!=typeof t.selector&&void 0!==t.selector:e="options.selector must be a string or undefined";break;case"string"==typeof t.selector&&null===document.querySelector(t.selector):e="options.selector must be a DOM selector";break;case"number"!=typeof t.width&&void 0!==t.width:e="options.width must be a number or undefined";break;case"number"==typeof t.width&&0===t.width:e="options.width must be a number > 0 or undefined";break;case"number"!=typeof t.height&&void 0!==t.height:e="options.height must be a number or undefined";break;case"number"==typeof t.height&&0===t.height:e="options.height must be a number > 0 or undefined";break;case"number"!=typeof t.interval&&void 0!==t.interval:e="options.interval must be a number or undefined";break;case"number"==typeof t.interval&&0===t.interval:e="options.interval must be a number > 0 or undefined";break;case"string"!=typeof t.possible&&void 0!==t.possible:e="options.possible must be a string or undefined";break;case"string"==typeof t.possible&&0===t.possible.length:e="options.possible must be a string > 0 or undefined";break;case!Array.isArray(t.style)&&void 0!==t.style:e="options.style must be an array or undefined";break;case Array.isArray(t.style)&&0===t.style.length:e="options.style must be an array > 0";break;case"function"!=typeof t.callback&&null!==t.callback&&void 0!==t.callback:e="options.callback must be a function, null or undefined"}return 0===e.length?t:{error:e}}}]),t}(),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();
var o=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._defaults={message:void 0,selector:"[data-randrix]",width:5,height:6,interval:100,possible:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",style:void 0,callback:null},this._options=s.options(e),this._options.error)return this.throwError();this._settings=Object.assign({},this._defaults,this._options),this._message=this._settings.message.split(""),this._element=document.querySelector(this._settings.selector),this._width=this._settings.width,this._height=this._settings.height,this._interval=this._settings.interval,this._possible=this._settings.possible,this._possibleLength=this._possible.length,this._style=this._settings.style,this._styleLength=this._style?this._style.length:0,this._styleEnable=this._styleLength>0,this._index=0,this._matrix=[],this._x=0,this._y=0,this._callback=this._settings.callback,this._calledback=!1}return a(t,[{key:"throwError",value:function(){throw new Error(this._options.error)}},{key:"isCallback",value:function(){return"function"==typeof this._callback&&!1===this._calledback}},{key:"char",value:function(){return this._possible.charAt(Math.floor(Math.random()*this._possibleLength))}},{key:"charStyle",value:function(){return this._style?this._style[Math.floor(Math.random()*this._styleLength)]:""}},{key:"charCreate",value:function(t,e){var i="x"+t+"-y"+e;return this._matrix[i]={element:this.charCreateElement(i)||{},x:t,y:e,interval:this.charStart(i)||function(){return!1}},!0}},{key:"charCreateElement",value:function(t){var e=this.char(),i=document.createElement("span"),r=document.createTextNode(e);return i.appendChild(r),i.setAttribute("data-randrix-char",t),this._styleEnable&&this.charStyle()&&i.setAttribute("data-randrix-style",this.charStyle()),this._element.appendChild(i),i}},{key:"charIsLastChild",value:function(t){return this._x===this._width-1&&this._y===this._height-1}},{key:"charUpdate",value:function(t){var e=this.char();this.charUpdateElement(t,e),this.charUpdateStatus(t,e)}},{key:"charUpdateElement",value:function(t,e){this._matrix[t]&&this._matrix[t].element&&(this._styleEnable&&this._matrix[t].element.setAttribute("data-randrix-style",this.charStyle()),this._matrix[t].element.innerHTML=e)}},{key:"charUpdateStatus",value:function(t,e){this._message.length!==this._index?this.charIsLastChild()?this.reset():!this.charMatch(t,e)||this.charActivate(t):(this.charStop(t),this.isCallback()&&(this._calledback=this._callback()))}},{key:"charMatch",value:function(t,e){return!(!this.charMatchIndex(e)||!this.charMatchPosition(t))&&(this._debug&&console.log("next","x"+this._x,"y"+this._y,"c"+e),!0)}},{key:"charMatchIndex",value:function(t){return this._message[this._index]===t}},{key:"charMatchPosition",value:function(t){return!!this._matrix[t]&&(0===this._index&&0===this._matrix[t].x||this._x===this._matrix[t].x&&this._y+1===this._matrix[t].y||this._x+1===this._matrix[t].x&&0===this._matrix[t].y)}},{key:"charActivate",value:function(t){return!!this._matrix[t]&&(this._index=this._index+1,this._x=this._matrix[t].x,this._y=this._matrix[t].y,this.charStop(t),this._matrix[t].element.setAttribute("data-randrix-char-active","true"),!0)}},{key:"charStop",value:function(t){return this._matrix[t]?clearInterval(this._matrix[t].interval):function(){return!1}}},{key:"charStart",value:function(t){var e=this;return setInterval(function(){e.charUpdate(t)},this._interval)}},{key:"create",value:function(){for(var t=0;t<this._width;t++)for(var e=0;e<this._height;e++)this.charCreate(t,e);return!0}},{key:"reset",value:function(){var t=this;return this._element.innerHTML="",this.stop(function(){t.constructor(t._settings),t.start()}),!0}},{key:"stop",value:function(t){for(var e in this._matrix)this._matrix.hasOwnProperty(e)&&clearInterval(this._matrix[e].interval);return"function"==typeof t&&t(),!0}},{key:"start",value:function(){return 0===this._index?this.create():this.reset(),!0}}]),t}();e.default=o}])});